# Story 06.001: Avalonia UI Project Setup

## Status
Done

## Story
**As a** developer implementing the GUI feature,  
**I want** to set up the Avalonia UI project infrastructure with proper dependencies and configuration,  
**so that** I have a foundation for building the cross-platform desktop application.

## Acceptance Criteria
1. New `DocxTemplate.UI` project created with Avalonia UI 11.x framework
2. Project references ReactiveUI for MVVM pattern implementation
3. Self-contained deployment configuration for Windows and macOS
4. Basic application window loads successfully
5. Project follows established solution structure and naming conventions
6. CLI integration layer structure prepared (without implementation)

## Tasks / Subtasks
- [ ] Create Avalonia UI project structure (AC: 1, 5)
  - [ ] Add `src/DocxTemplate.UI` project to solution
  - [ ] Configure Avalonia UI 11.x package references
  - [ ] Set up project file with proper target framework (.NET 9.0)
- [ ] Configure MVVM framework (AC: 2)
  - [ ] Add ReactiveUI package reference
  - [ ] Set up ViewModelBase and basic reactive properties
- [ ] Set up deployment configuration (AC: 3)  
  - [ ] Configure self-contained publishing for win-x64
  - [ ] Configure self-contained publishing for osx-x64
  - [ ] Verify single-file deployment settings
- [ ] Create basic application shell (AC: 4)
  - [ ] Implement App.axaml and App.axaml.cs
  - [ ] Create MainWindow.axaml with basic layout
  - [ ] Create MainWindowViewModel with basic properties
- [ ] Prepare CLI integration structure (AC: 6)
  - [ ] Create Services folder with CLI integration interfaces
  - [ ] Create CliCommandBuilder stub class
  - [ ] Create CliResultParser stub class  
  - [ ] Create CliProcessRunner stub class

## Dev Notes

### Architecture Context
Based on GUI PRD Phase 1 requirements and technical architecture section:

**Technology Stack:**
- UI Framework: Avalonia UI 11.x for cross-platform desktop applications
- MVVM Framework: ReactiveUI for property notifications and commanding
- Target Framework: .NET 9.0 (updated from PRD's .NET 8.0 per current project)
- Deployment: Self-contained single-file executables

**Integration Approach:**
- GUI does NOT reference CLI libraries or assemblies
- All communication via external process execution and JSON parsing
- Clean separation between GUI and CLI layers

**Project Structure:**
Following existing solution pattern with Core/Infrastructure/CLI separation, add:
```
src/DocxTemplate.UI/
├── App.axaml
├── App.axaml.cs  
├── ViewModels/
│   └── MainWindowViewModel.cs
├── Views/
│   └── MainWindow.axaml
└── Services/
    ├── ICliCommandService.cs
    ├── CliCommandBuilder.cs
    ├── CliResultParser.cs
    └── CliProcessRunner.cs
```

**CLI Integration Layer Design:**
- CliCommandBuilder: Constructs command strings for CLI execution
- CliResultParser: Parses JSON output from CLI commands  
- CliProcessRunner: Manages Process.Start execution of CLI commands

### Testing
**Testing Standards:**
- Unit tests location: `tests/DocxTemplate.UI.Tests/`
- Use XUnit framework (consistent with existing project)
- Test ViewModels with ReactiveUI testing patterns
- Mock CLI integration services for isolated testing
- Integration tests should verify basic window loading

**Specific Testing Requirements:**
- Test Avalonia application startup and shutdown
- Verify ReactiveUI property change notifications
- Test CLI service stub interfaces are properly injectable

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-01-18 | 1.0 | Initial story creation | BMad Master |

## Dev Agent Record
*This section is populated by the development agent during implementation*

### Agent Model Used
Claude Sonnet 4 (claude-sonnet-4-20250514)

### Debug Log References
- Initial ReactiveUI version issue resolved (20.1.1 → 14.7.1)
- XAML StatusBar control replaced with Border for compatibility
- Self-contained deployment configuration tested successfully

### Completion Notes List
- ✅ Created DocxTemplate.UI project with Avalonia 11.3.4 and ReactiveUI 14.7.1
- ✅ Configured self-contained deployment for cross-platform distribution
- ✅ Implemented basic Czech language UI with "Procesor šablon DOCX" title
- ✅ Created CLI integration service layer structure with stubs
- ✅ Added comprehensive test project with Avalonia.Headless for UI testing
- ✅ All acceptance criteria met and verified through build and test execution

### File List
**Created Files:**
- `src/DocxTemplate.UI/` - Main UI project (Avalonia MVVM template)
- `src/DocxTemplate.UI/Services/ICliCommandService.cs` - CLI integration interface
- `src/DocxTemplate.UI/Services/CliCommandBuilder.cs` - Command string builder
- `src/DocxTemplate.UI/Services/CliResultParser.cs` - JSON response parser
- `src/DocxTemplate.UI/Services/CliProcessRunner.cs` - Process execution service
- `tests/DocxTemplate.UI.Tests/` - UI test project
- `tests/DocxTemplate.UI.Tests/ViewModels/MainWindowViewModelTests.cs` - ViewModel tests
- `tests/DocxTemplate.UI.Tests/Services/CliCommandBuilderTests.cs` - Service tests

**Modified Files:**
- `DocxTemplate.sln` - Added UI and UI.Tests projects
- `src/DocxTemplate.UI/DocxTemplate.UI.csproj` - Added ReactiveUI, self-contained config
- `src/DocxTemplate.UI/ViewModels/ViewModelBase.cs` - ReactiveUI integration
- `src/DocxTemplate.UI/ViewModels/MainWindowViewModel.cs` - Czech language properties
- `src/DocxTemplate.UI/Views/MainWindow.axaml` - Czech UI layout

## QA Results
*Results from QA Agent QA review of the completed story implementation*