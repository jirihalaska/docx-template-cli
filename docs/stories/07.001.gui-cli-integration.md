# Story 07.001: GUI-CLI Integration

## Status
Draft

## Story
**As a** GUI application developer,  
**I want** the GUI to automatically locate and execute the CLI executable in the same directory,  
**so that** users get a seamless integrated experience without manual CLI setup.

## Acceptance Criteria
1. GUI searches for CLI executable (`docx-template.exe` or `docx-template`) in same directory as GUI executable
2. GUI displays clear error message if CLI executable not found in same directory  
3. All GUI operations are executed via CLI commands with JSON output parsing
4. GUI passes all parameters to CLI via command-line arguments (no shared assemblies)
5. GUI handles CLI process errors and timeouts gracefully
6. Integration works on both Windows and macOS platforms

## Tasks / Subtasks
- [ ] Create CLI executable discovery service (AC: 1, 2)
  - [ ] Implement same-directory search logic
  - [ ] Add user-friendly error handling for missing CLI
  - [ ] Add platform-specific executable name handling (.exe vs no extension)
- [ ] Enhance existing CLI command execution layer (AC: 3, 4)  
  - [ ] Update command builder to use discovered CLI executable path
  - [ ] Ensure JSON response parser works with all CLI commands
  - [ ] Verify process execution with timeout handling
- [ ] Implement error handling and recovery (AC: 5)
  - [ ] Handle CLI process crashes
  - [ ] Handle CLI timeout scenarios
  - [ ] Provide actionable error messages to users
- [ ] Cross-platform testing (AC: 6)
  - [ ] Test on Windows with .exe extension
  - [ ] Test on macOS without extension
  - [ ] Verify error handling on both platforms

## Dev Notes
### Architecture Context
- **NOTE**: CLI command execution layer should already be implemented in GUI
- GUI must NOT reference CLI assemblies directly - only process-based communication
- All CLI commands documented in `docs/cli-reference.md` with JSON schemas
- GUI uses Avalonia UI framework with MVVM pattern
- Integration layer sits between ViewModels and CLI process execution
- Focus of this story is CLI executable discovery, not building command execution from scratch

### CLI Commands Required
- `list-sets --templates ./templates --format json`
- `scan --path "./templates/SelectedSet" --format json`  
- `copy --source "./templates/SelectedSet" --target "./output" --format json`
- `replace --folder "./output" --map "./temp_values.json" --format json`

### Testing Standards
- Unit tests for CLI integration service in `DocxTemplate.Tests/Unit/Integration/`
- Integration tests with real CLI executable in `DocxTemplate.Tests/Integration/`
- Mock CLI responses for unit testing GUI components
- Use XUnit framework with arrange, act, assert pattern

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-08-18 | 1.0 | Initial story creation for FR13 implementation | BMad Master |

## Dev Agent Record
_(This section is populated by the development agent during implementation)_

## QA Results  
_(Results from QA Agent QA review of the completed story implementation)_